<html STYLE="width: 432px; height: 168px; ">
<head><title>Insertar tabla</title><head>
<style>
  html, body, button, div, input, select, td, fieldset { font-family: MS Shell Dlg; font-size: 8pt; };
</style>
<script>

// if we pass the "window" object as a argument and then set opener to
// equal that we can refer to dialogWindows and popupWindows the same way
opener = window.dialogArguments;

var _editor_url = opener._editor_url;
var objname     = location.search.substring(1,location.search.length);
var config      = opener.document.all[objname].config;
var editor_obj  = opener.document.all["_" +objname+  "_editor"];
var editdoc     = editor_obj.contentWindow.document;

function _CloseOnEsc() {
  if (event.keyCode == 27) { window.close(); return; }
}

window.onerror = HandleError

function HandleError(message, url, line) {
  var str = "Ha ocurrido un error en este diálogo." + "\n\n"
  + "Error: " + line + "\n" + message;
  alert(str);
//  window.close();
  return true;
}

function Init() {
  document.body.onkeypress = _CloseOnEsc;
}

function _isValidNumber(txtBox) {
  var val = parseInt(txtBox);
  if (isNaN(val) || val < 0 || val > 9999) { return false; }
  return true;
}

function btnOKClick() {
  var curRange = editdoc.selection.createRange();

  // error checking
  var checkList = ['rows','cols','border','cellspacing','cellpadding'];
/*  for (var idx in checkList) {
    var fieldname = checkList[idx];
    if (document.all[fieldname].value == "") {
      alert("You must specify a value for the '" +fieldname+ "' field!");
      document.all[fieldname].focus();
      return;
    }
    else if (!_isValidNumber(document.all[fieldname].value)) {
      alert("You must specify a number between 0 and 9999 for '" +fieldname+ "'!");
      document.all[fieldname].focus();
      return;
    }
  }
*/

  // delete selected content (if applicable)
  if (editdoc.selection.type == "Control" || curRange.htmlText) {

    if (!confirm("¿Sobrescribir el contenido seleccionado?")) { return; }

    curRange.execCommand('Delete');
    curRange = editdoc.selection.createRange();
  }

  // create table
  var table = '<table border="' +document.all.border.value+ '"'
            + ' cellspacing="' +document.all.cellspacing.value+ '"'
            + ' cellpadding="' +document.all.cellpadding.value+ '"'
            + ' class="' +document.all.tipo.value+ '"'
            + ' align="' +document.all.alignment.value+ '">\n';

  for (var x=0; x<document.all.rows.value; x++) {
    table += " <tr>\n";
    for (var y=0; y<document.all.cols.value; y++) {
      table += "  <td>Celda "+(x+1)+'-'+(y+1)+"</td>\n";
    }
    table += " </tr>\n";
  }
  table += "</table>\n";

  // insert table
  opener.editor_insertHTML(objname, table);


  // close popup window
  window.close();
}
</SCRIPT>
</HEAD>
<BODY class="bodyAdmin" id=bdy style="background: threedface; color: windowtext; margin: 10px; BORDER-STYLE: none" onload="Init()" scroll=no>
Insertar tabla de tipo:<br>
<br>
<select name="tipo" id="tipo">
  <option selected>Normal
  <option value="resalte">Resaltado 1
</select>
<input name="rows" type="hidden"  style="width: 50px" value="1">
<input name="cols" type="hidden"  style="width: 50px" value="1">
<input name="width" type="hidden" style="width: 50px" value="100">
<input name="widthExt" type="hidden" id="widthExt" value="%">
<input name="alignment" type="hidden" id="alignment" value="">
<input name="border" type="hidden">
<input name="cellspacing" type="hidden" style="width: 50px">
<input name="cellpadding" type="hidden" style="width: 50px">
<div align="right"><BUTTON type=submit onclick="btnOKClick()">Aceptar </BUTTON>
<BUTTON type=reset onClick="window.close();">Cancelar</BUTTON></div>

<script language="">
//btnOKClick()
</script>
<br>
</BODY>
</HTML>